<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Semantic differences from other backends | Why JavaScript?</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="./JavaScript-target-versions.html" />
    
    
    <link rel="prev" href="./How-to-adapt-your-build-system.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="3.5"
        data-chapter-title="Semantic differences from other backends"
        data-filepath="Semantic-differences-from-other-backends.md"
        data-basepath="."
        data-revision="Thu May 26 2016 10:01:02 GMT-0400 (EDT)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Home
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" >
            
            <span><b>1.</b> Playground</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" >
            
                
                    <a target="_blank" href="https:/bloomberg.github.io/bucklescript/js-demo">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        OCaml Playground
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                
                    <a target="_blank" href="https:/bloomberg.github.io/bucklescript/reason-demo">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Reason Playground
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" >
            
            <span><b>2.</b> Get Started</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="Installation.html">
            
                
                    <a href="./Installation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Installation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="Create-a-simple-example-with-NPM.html">
            
                
                    <a href="./Create-a-simple-example-with-NPM.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Create a simple example with NPM
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="NPM-Support.html">
            
                
                    <a href="./NPM-Support.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        NPM Support
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" >
            
            <span><b>3.</b> BuckleScript Basics</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="FAQ.html">
            
                
                    <a href="./FAQ.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        FAQ
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" >
            
                
                    <a target="_blank" href="https:/ocaml.org/">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        About OCaml
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="Compiler-options.html">
            
                
                    <a href="./Compiler-options.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Compiler options
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="How-to-adapt-your-build-system.html">
            
                
                    <a href="./How-to-adapt-your-build-system.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        How to adapt your build system
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="3.5" data-path="Semantic-differences-from-other-backends.html">
            
                
                    <a href="./Semantic-differences-from-other-backends.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Semantic differences from other backends
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="JavaScript-target-versions.html">
            
                
                    <a href="./JavaScript-target-versions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        JavaScript target versions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" >
            
            <span><b>4.</b> BuckleScript Overview</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="Compiler-overview.html">
            
                
                    <a href="./Compiler-overview.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Compiler overview
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" >
            
            <span><b>5.</b> BuckleScript FFI</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="Curry-and-Uncurry-functions.html">
            
                
                    <a href="./Curry-and-Uncurry-functions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Curry and Uncurry functions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="JS-call-OCaml.html">
            
                
                    <a href="./JS-call-OCaml.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        JS call OCaml
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="OCaml-call-JS.html">
            
                
                    <a href="./OCaml-call-JS.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        OCaml call JS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="Runtime-representation.html">
            
                
                    <a href="./Runtime-representation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        Runtime representation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="Experimental-support-of-typescript.html">
            
                
                    <a href="./Experimental-support-of-typescript.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                        Experimental support of typescript
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="Unsupported-IO-primitives.html">
            
                
                    <a href="./Unsupported-IO-primitives.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.</b>
                        
                        Unsupported IO primitives
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" >
            
            <span><b>6.</b> Contributions</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" >
            
                
                    <a target="_blank" href="https:/github.com/bloomberg/bucklescript">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Github Link
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="Dev-mode-How-to.html">
            
                
                    <a href="./Dev-mode-How-to.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        Dev mode How to
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="Help-move-runtime-functions-from-OCaml-to-Javascript.html">
            
                
                    <a href="./Help-move-runtime-functions-from-OCaml-to-Javascript.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.</b>
                        
                        Help move runtime functions from OCaml to Javascript
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" >
            
            <span><b>7.</b> Roadmap</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="Roadmap.html">
            
                
                    <a href="./Roadmap.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        Roadmap
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" >
            
            <span><b>8.</b> Comparisons</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="Differences-from-js_of_ocaml.html">
            
                
                    <a href="./Differences-from-js_of_ocaml.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        Differences from js_of_ocaml
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Why JavaScript?</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <p>This section describe the semantic difference between BuckleScript generated code and other backend. This is particularly important when porting an existing application to JavaScript.</p>
<h1 id="custom-data-type">Custom data type</h1>
<p>   In OCaml, the C FFI allows user to  define a custom data type and customize <code>caml_compare</code>, <code>caml_hash</code> behavior, etc.   This is not available in our backend (since we have no C FFI)</p>
<h1 id="physical-inequality">Physical (in)equality</h1>
<p>   In general, you should only use physical equality as an optimization technique, but not rely on its correctness, since it is hardly coupled with the runtime.</p>
<h1 id="string-char-range">String char range</h1>
<p>   Currently, BuckleScript assumes that the char ranges is <code>0-255</code>, user should be careful when they pass JavaScript string to OCaml side. Note that we are working on a solution for this problem.</p>
<h1 id="weak-map">Weak map</h1>
<p>  OCaml&apos;s weak map is not available in BuckleScript. The weak pointer is replaced by a strict pointer.</p>
<h1 id="integers">Integers</h1>
<p>OCaml has <code>int</code>, <code>int32</code>, <code>nativeint</code> and <code>int64</code> types. Both <code>int32</code> and <code>int64</code> have the exact same semantic.</p>
<ul>
<li><p><code>int</code>
<code>int</code> in BuckleScript is the same as <code>int32</code> while it&apos;s platform dependent.</p>
</li>
<li><p><code>nativeint</code>
Treated as JavaScript float, except for division, for example, <code>Nativeint.div a b</code> will be translated into <code>a /b | 0</code>. </p>
</li>
</ul>
<blockquote>
<p>Note there is a subtle difference that <code>Nativeint.shift_right_logical x 0</code> is different from <code>Int32.shift_right_local x 0</code>, the former is literally translated into <code>x &gt;&gt;&gt; 0</code> (translated into an unsigned int), while the latter is <code>x | 0</code>.</p>
</blockquote>
<ul>
<li><p><code>Printf.printf</code>
<code>Printf.print</code> implementation in BuckleScript requires a newline (<code>\n</code>) to trigger the printing. This behavior is not consistent with the buffered behavior of native OCaml. The only potential problem we foresee is that if the program terminates with no newline character, the text will never be printed.</p>
</li>
<li><p><code>Obj</code> module
We do our best to mimic the native compiler but we have no guarantee and there are differences.</p>
</li>
<li><p><code>Hashtbl</code>
BuckleScript uses the same algorithm as native OCaml but the output is different due to runtime representation of int/int64/int32 and float.</p>
</li>
<li><p><code>Marshall</code>
Marshall module is not supported.</p>
</li>
<li><p><code>Sys.argv</code>
Command line argument are always empty.</p>
</li>
</ul>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./How-to-adapt-your-build-system.html" class="navigation navigation-prev " aria-label="Previous page: How to adapt your build system"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./JavaScript-target-versions.html" class="navigation navigation-next " aria-label="Next page: JavaScript target versions"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-edit-link/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"edit-link":{"base":"https://github.com/bloomberg/bucklescript/tree/master/docs","label":"Edit This Page"},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
